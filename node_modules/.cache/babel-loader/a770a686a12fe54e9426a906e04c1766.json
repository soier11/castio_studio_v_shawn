{"ast":null,"code":"import React,{Component,Fragment}from\"react\";import{Row}from\"reactstrap\";import axios from\"axios\";import{servicePath}from\"../../../constants/defaultValues\";import classesData from\"../../../data/classes\";import DataListView from\"../../../containers/pages/DataListView\";import Pagination from\"../../../containers/pages/Pagination\";import ContextMenuContainer from\"../../../containers/pages/ContextMenuContainer\";import ListPageHeading from\"../../../containers/pages/ListPageHeading\";import ImageListView from\"../../../containers/pages/ImageListView\";import ThumbListView from\"../../../containers/pages/ThumbListView\";import AddNewModal from\"../../../containers/pages/AddNewModal\";function collect(props){return{data:props.data};}const apiUrl=servicePath+\"/cakes/paging\";class ClassPage extends Component{constructor(props){super(props);this.toggleModal=()=>{this.setState({modalOpen:!this.state.modalOpen});};this.changeOrderBy=column=>{this.setState({selectedOrderOption:this.state.orderOptions.find(x=>x.column===column)},()=>this.dataListRender());};this.changePageSize=size=>{this.setState({selectedPageSize:size,currentPage:1},()=>this.dataListRender());};this.changeDisplayMode=mode=>{this.setState({displayMode:mode});return false;};this.onChangePage=page=>{this.setState({currentPage:page},()=>this.dataListRender());};this.onSearchKey=e=>{if(e.key===\"Enter\"){this.setState({search:e.target.value.toLowerCase()},()=>this.dataListRender());}};this.onCheckItem=(event,id)=>{if(event.target.tagName===\"A\"||event.target.parentElement&&event.target.parentElement.tagName===\"A\"){return true;}if(this.state.lastChecked===null){this.setState({lastChecked:id});}let selectedItems=this.state.selectedItems;if(selectedItems.includes(id)){selectedItems=selectedItems.filter(x=>x!==id);}else{selectedItems.push(id);}this.setState({selectedItems});if(event.shiftKey){var items=this.state.items;var start=this.getIndex(id,items,\"id\");var end=this.getIndex(this.state.lastChecked,items,\"id\");items=items.slice(Math.min(start,end),Math.max(start,end)+1);selectedItems.push(...items.map(item=>{return item.id;}));selectedItems=Array.from(new Set(selectedItems));this.setState({selectedItems});}document.activeElement.blur();};this.handleChangeSelectAll=isToggle=>{if(this.state.selectedItems.length>=this.state.items.length){if(isToggle){this.setState({selectedItems:[]});}}else{this.setState({selectedItems:this.state.items.map(x=>x.id)});}document.activeElement.blur();return false;};this.onContextMenuClick=(e,data,target)=>{console.log(\"onContextMenuClick - selected items\",this.state.selectedItems);console.log(\"onContextMenuClick - action : \",data.action);};this.onContextMenu=(e,data)=>{const clickedProductId=data.data;if(!this.state.selectedItems.includes(clickedProductId)){this.setState({selectedItems:[clickedProductId]});}return true;};this.mouseTrap=require('mousetrap');this.state={displayMode:\"imagelist\",selectedPageSize:8,orderOptions:[{column:\"title\",label:\"Product Name\"},{column:\"category\",label:\"Category\"},{column:\"status\",label:\"Status\"}],pageSizes:[8,12,24],categories:[{label:\"Cakes\",value:\"Cakes\",key:0},{label:\"Cupcakes\",value:\"Cupcakes\",key:1},{label:\"Desserts\",value:\"Desserts\",key:2}],selectedOrderOption:{column:\"title\",label:\"Product Name\"},dropdownSplitOpen:false,modalOpen:false,currentPage:1,totalItemCount:0,totalPage:1,search:\"\",selectedItems:[],lastChecked:null,isLoading:false};}componentDidMount(){this.dataListRender();this.mouseTrap.bind([\"ctrl+a\",\"command+a\"],()=>this.handleChangeSelectAll(false));this.mouseTrap.bind([\"ctrl+d\",\"command+d\"],()=>{this.setState({selectedItems:[]});return false;});}componentWillUnmount(){this.mouseTrap.unbind(\"ctrl+a\");this.mouseTrap.unbind(\"command+a\");this.mouseTrap.unbind(\"ctrl+d\");this.mouseTrap.unbind(\"command+d\");}getIndex(value,arr,prop){for(var i=0;i<arr.length;i++){if(arr[i][prop]===value){return i;}}return-1;}dataListRender(){const _this$state=this.state,selectedPageSize=_this$state.selectedPageSize,currentPage=_this$state.currentPage,selectedOrderOption=_this$state.selectedOrderOption,search=_this$state.search;axios.get(\"\".concat(apiUrl,\"?pageSize=\").concat(selectedPageSize,\"&currentPage=\").concat(currentPage,\"&orderBy=\").concat(selectedOrderOption.column,\"&search=\").concat(search)).then(res=>{return res.data;}).then(data=>{this.setState({totalPage:data.totalPage,items:data.data,selectedItems:[],totalItemCount:data.totalItem,isLoading:true});});}render(){const _this$state2=this.state,currentPage=_this$state2.currentPage,items=_this$state2.items,displayMode=_this$state2.displayMode,selectedPageSize=_this$state2.selectedPageSize,totalItemCount=_this$state2.totalItemCount,selectedOrderOption=_this$state2.selectedOrderOption,selectedItems=_this$state2.selectedItems,orderOptions=_this$state2.orderOptions,pageSizes=_this$state2.pageSizes,modalOpen=_this$state2.modalOpen,categories=_this$state2.categories;const match=this.props.match;const startIndex=(currentPage-1)*selectedPageSize;const endIndex=currentPage*selectedPageSize;console.log(match);return!this.state.isLoading?/*#__PURE__*/React.createElement(\"div\",{className:\"loading\"}):/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"div\",{className:\"disable-text-selection\"},/*#__PURE__*/React.createElement(ListPageHeading,{heading:\"menu.class\",displayMode:displayMode,changeDisplayMode:this.changeDisplayMode,handleChangeSelectAll:this.handleChangeSelectAll,changeOrderBy:this.changeOrderBy,changePageSize:this.changePageSize,selectedPageSize:selectedPageSize,totalItemCount:totalItemCount,selectedOrderOption:selectedOrderOption,match:match,startIndex:startIndex,endIndex:endIndex,selectedItemsLength:selectedItems?selectedItems.length:0,itemsLength:items?items.length:0,onSearchKey:this.onSearchKey,orderOptions:orderOptions,pageSizes:pageSizes,toggleModal:this.toggleModal}),/*#__PURE__*/React.createElement(AddNewModal,{modalOpen:modalOpen,toggleModal:this.toggleModal,categories:categories}),/*#__PURE__*/React.createElement(Row,null,this.state.items.map(product=>{if(this.state.displayMode===\"imagelist\"){return/*#__PURE__*/React.createElement(ImageListView,{key:product.id,product:product,isSelect:this.state.selectedItems.includes(product.id),collect:collect// onCheckItem={null}\n,servicePath:\"./\".concat(product.id)});}else if(this.state.displayMode===\"thumblist\"){return/*#__PURE__*/React.createElement(ThumbListView,{key:product.id,product:product,isSelect:this.state.selectedItems.includes(product.id),collect:collect,servicePath:\"./\".concat(product.id)// onCheckItem={this.onCheckItem}\n});}else{return/*#__PURE__*/React.createElement(DataListView,{key:product.id,product:product,isSelect:this.state.selectedItems.includes(product.id),collect:collect,servicePath:\"./\".concat(product.id)// onCheckItem={this.onCheckItem}\n});}}),\" \",/*#__PURE__*/React.createElement(Pagination,{currentPage:this.state.currentPage,totalPage:this.state.totalPage,onChangePage:i=>this.onChangePage(i)}),/*#__PURE__*/React.createElement(ContextMenuContainer,{onContextMenuClick:this.onContextMenuClick,onContextMenu:this.onContextMenu}))));}}export default ClassPage;","map":{"version":3,"sources":["/Users/soier/Code/studio_v_shawn/studio_v2/src/views/studio/classpage/class.js"],"names":["React","Component","Fragment","Row","axios","servicePath","classesData","DataListView","Pagination","ContextMenuContainer","ListPageHeading","ImageListView","ThumbListView","AddNewModal","collect","props","data","apiUrl","ClassPage","constructor","toggleModal","setState","modalOpen","state","changeOrderBy","column","selectedOrderOption","orderOptions","find","x","dataListRender","changePageSize","size","selectedPageSize","currentPage","changeDisplayMode","mode","displayMode","onChangePage","page","onSearchKey","e","key","search","target","value","toLowerCase","onCheckItem","event","id","tagName","parentElement","lastChecked","selectedItems","includes","filter","push","shiftKey","items","start","getIndex","end","slice","Math","min","max","map","item","Array","from","Set","document","activeElement","blur","handleChangeSelectAll","isToggle","length","onContextMenuClick","console","log","action","onContextMenu","clickedProductId","mouseTrap","require","label","pageSizes","categories","dropdownSplitOpen","totalItemCount","totalPage","isLoading","componentDidMount","bind","componentWillUnmount","unbind","arr","prop","i","get","then","res","totalItem","render","match","startIndex","endIndex","product"],"mappings":"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","sourcesContent":["import React, { Component, Fragment } from \"react\";\nimport { Row } from \"reactstrap\";\nimport axios from \"axios\";\n\nimport { servicePath } from \"../../../constants/defaultValues\";\nimport classesData from \"../../../data/classes\";\n\nimport DataListView from \"../../../containers/pages/DataListView\";\nimport Pagination from \"../../../containers/pages/Pagination\";\nimport ContextMenuContainer from \"../../../containers/pages/ContextMenuContainer\";\nimport ListPageHeading from \"../../../containers/pages/ListPageHeading\";\nimport ImageListView from \"../../../containers/pages/ImageListView\";\nimport ThumbListView from \"../../../containers/pages/ThumbListView\";\nimport AddNewModal from \"../../../containers/pages/AddNewModal\";\n\nfunction collect(props) {\n  return { data: props.data };\n}\nconst apiUrl = servicePath + \"/cakes/paging\";\n\nclass ClassPage extends Component {\n  constructor(props) {\n    super(props);\n    this.mouseTrap = require('mousetrap');\n\n    this.state = {\n      displayMode: \"imagelist\",\n\n      selectedPageSize: 8,\n      orderOptions: [\n        { column: \"title\", label: \"Product Name\" },\n        { column: \"category\", label: \"Category\" },\n        { column: \"status\", label: \"Status\" }\n      ],\n      pageSizes: [8, 12, 24],\n\n      categories: [\n        { label: \"Cakes\", value: \"Cakes\", key: 0 },\n        { label: \"Cupcakes\", value: \"Cupcakes\", key: 1 },\n        { label: \"Desserts\", value: \"Desserts\", key: 2 }\n      ],\n\n      selectedOrderOption: { column: \"title\", label: \"Product Name\" },\n      dropdownSplitOpen: false,\n      modalOpen: false,\n      currentPage: 1,\n      totalItemCount: 0,\n      totalPage: 1,\n      search: \"\",\n      selectedItems: [],\n      lastChecked: null,\n      isLoading: false\n    };\n  }\n\n  componentDidMount() {\n    this.dataListRender();\n    this.mouseTrap.bind([\"ctrl+a\", \"command+a\"], () =>\n      this.handleChangeSelectAll(false)\n    );\n    this.mouseTrap.bind([\"ctrl+d\", \"command+d\"], () => {\n      this.setState({\n        selectedItems: []\n      });\n      return false;\n    });\n  }\n\n  componentWillUnmount() {\n    this.mouseTrap.unbind(\"ctrl+a\");\n    this.mouseTrap.unbind(\"command+a\");\n    this.mouseTrap.unbind(\"ctrl+d\");\n    this.mouseTrap.unbind(\"command+d\");\n  }\n\n\n  toggleModal = () => {\n    this.setState({\n      modalOpen: !this.state.modalOpen\n    });\n  };\n\n  changeOrderBy = column => {\n    this.setState(\n      {\n        selectedOrderOption: this.state.orderOptions.find(\n          x => x.column === column\n        )\n      },\n      () => this.dataListRender()\n    );\n  };\n  changePageSize = size => {\n    this.setState(\n      {\n        selectedPageSize: size,\n        currentPage: 1\n      },\n      () => this.dataListRender()\n    );\n  };\n  changeDisplayMode = mode => {\n    this.setState({\n      displayMode: mode\n    });\n    return false;\n  };\n  onChangePage = page => {\n    this.setState(\n      {\n        currentPage: page\n      },\n      () => this.dataListRender()\n    );\n  };\n\n  onSearchKey = e => {\n    if (e.key === \"Enter\") {\n      this.setState(\n        {\n          search: e.target.value.toLowerCase()\n        },\n        () => this.dataListRender()\n      );\n    }\n  };\n\n  onCheckItem = (event, id) => {\n    if (\n      event.target.tagName === \"A\" ||\n      (event.target.parentElement && event.target.parentElement.tagName === \"A\")\n    ) {\n      return true;\n    }\n    if (this.state.lastChecked === null) {\n      this.setState({\n        lastChecked: id\n      });\n    }\n\n    let selectedItems = this.state.selectedItems;\n    if (selectedItems.includes(id)) {\n      selectedItems = selectedItems.filter(x => x !== id);\n    } else {\n      selectedItems.push(id);\n    }\n    this.setState({\n      selectedItems\n    });\n\n    if (event.shiftKey) {\n      var items = this.state.items;\n      var start = this.getIndex(id, items, \"id\");\n      var end = this.getIndex(this.state.lastChecked, items, \"id\");\n      items = items.slice(Math.min(start, end), Math.max(start, end) + 1);\n      selectedItems.push(\n        ...items.map(item => {\n          return item.id;\n        })\n      );\n      selectedItems = Array.from(new Set(selectedItems));\n      this.setState({\n        selectedItems\n      });\n    }\n    document.activeElement.blur();\n  };\n\n  getIndex(value, arr, prop) {\n    for (var i = 0; i < arr.length; i++) {\n      if (arr[i][prop] === value) {\n        return i;\n      }\n    }\n    return -1;\n  }\n  handleChangeSelectAll = isToggle => {\n    if (this.state.selectedItems.length >= this.state.items.length) {\n      if (isToggle) {\n        this.setState({\n          selectedItems: []\n        });\n      }\n    } else {\n      this.setState({\n        selectedItems: this.state.items.map(x => x.id)\n      });\n    }\n    document.activeElement.blur();\n    return false;\n  };\n\n  dataListRender() {\n    const {\n      selectedPageSize,\n      currentPage,\n      selectedOrderOption,\n      search\n    } = this.state;\n    axios\n      .get(\n        `${apiUrl}?pageSize=${selectedPageSize}&currentPage=${currentPage}&orderBy=${\n          selectedOrderOption.column\n        }&search=${search}`\n      )\n      .then(res => {\n        return res.data;\n      })\n      .then(data => {\n        this.setState({\n          totalPage: data.totalPage,\n          items: data.data,\n          selectedItems: [],\n          totalItemCount: data.totalItem,\n          isLoading: true\n        });\n      });\n  }\n\n  onContextMenuClick = (e, data, target) => {\n    console.log(\n      \"onContextMenuClick - selected items\",\n      this.state.selectedItems\n    );\n    console.log(\"onContextMenuClick - action : \", data.action);\n  };\n\n  onContextMenu = (e, data) => {\n    const clickedProductId = data.data;\n    if (!this.state.selectedItems.includes(clickedProductId)) {\n      this.setState({\n        selectedItems: [clickedProductId]\n      });\n    }\n\n    return true;\n  };\n\n  render() {\n    const {\n      currentPage,\n      items,\n      displayMode,\n      selectedPageSize,\n      totalItemCount,\n      selectedOrderOption,\n      selectedItems,\n      orderOptions,\n      pageSizes,\n      modalOpen,\n      categories\n    } = this.state;\n    const { match } = this.props;\n    const startIndex = (currentPage - 1) * selectedPageSize;\n    const endIndex = currentPage * selectedPageSize;\n\n    console.log(match)\n\n    return !this.state.isLoading ? (\n      <div className=\"loading\" />\n    ) : (\n      <Fragment>\n        <div className=\"disable-text-selection\">\n          <ListPageHeading\n            heading=\"menu.class\"\n            displayMode={displayMode}\n            changeDisplayMode={this.changeDisplayMode}\n            handleChangeSelectAll={this.handleChangeSelectAll}\n            changeOrderBy={this.changeOrderBy}\n            changePageSize={this.changePageSize}\n            selectedPageSize={selectedPageSize}\n            totalItemCount={totalItemCount}\n            selectedOrderOption={selectedOrderOption}\n            match={match}\n            startIndex={startIndex}\n            endIndex={endIndex}\n            selectedItemsLength={selectedItems ? selectedItems.length : 0}\n            itemsLength={items ? items.length : 0}\n            onSearchKey={this.onSearchKey}\n            orderOptions={orderOptions}\n            pageSizes={pageSizes}\n            toggleModal={this.toggleModal}\n          />\n          <AddNewModal\n            modalOpen={modalOpen}\n            toggleModal={this.toggleModal}\n            categories={categories}\n          />\n          <Row>\n            {this.state.items.map(product => {\n              if (this.state.displayMode === \"imagelist\") {\n                return (\n                  <ImageListView\n                    key={product.id}\n                    product={product}\n                    isSelect={this.state.selectedItems.includes(product.id)}\n                    collect={collect}\n                    // onCheckItem={null}\n                    servicePath={`./${product.id}`}\n                  />\n                );\n              } else if (this.state.displayMode === \"thumblist\") {\n                return (\n                  <ThumbListView\n                    key={product.id}\n                    product={product}\n                    isSelect={this.state.selectedItems.includes(product.id)}\n                    collect={collect}\n                    servicePath={`./${product.id}`}\n                    // onCheckItem={this.onCheckItem}\n                  />\n                );\n              } else {\n                return (\n                  <DataListView\n                    key={product.id}\n                    product={product}\n                    isSelect={this.state.selectedItems.includes(product.id)}\n                    collect={collect}\n                    servicePath={`./${product.id}`}\n                    // onCheckItem={this.onCheckItem}\n                  />\n                );\n              }\n            })}{\" \"}\n            <Pagination\n              currentPage={this.state.currentPage}\n              totalPage={this.state.totalPage}\n              onChangePage={i => this.onChangePage(i)}\n            />\n            <ContextMenuContainer\n              onContextMenuClick={this.onContextMenuClick}\n              onContextMenu={this.onContextMenu}\n            />\n          </Row>\n        </div>\n      </Fragment>\n    );\n  }\n}\nexport default ClassPage;"]},"metadata":{},"sourceType":"module"}